<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
  <title>OCM Hybrid Â· Báº£n Ä‘á»“ sá»‘ Hoa ViÃªn</title>

  <!-- Favicon / Font giá»‘ng há»‡ cphaco.app -->
  <link rel="icon" type="image/png" href="/assets/CPH-LOGO-1.png">
  <link rel="apple-touch-icon" href="/assets/CPH-LOGO-1.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- MapLibre + Fuse -->
  <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
  <script src="https://unpkg.com/pmtiles@2.11.0/dist/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>

  <!-- CSS riÃªng cá»§a OCM -->
  <link rel="stylesheet" href="ocm-hybrid.css">
</head>
<body>
  <div id="map"></div>

  <!-- ===== TOP BAR ===== -->
  <div class="top-bar">
    <button class="gm-chip" id="btnMenu" title="Menu">â˜°</button>
    <div class="gm-search-wrap">
      <span style="opacity:.7">ğŸ”</span>
      <input id="searchInput" class="gm-search" type="text" placeholder="TÃ¬m má»™t Ä‘á»‹a Ä‘iá»ƒm, lÃ´ má»™..." />
      <div id="suggestList" class="suggest-list" role="listbox" aria-label="Gá»£i Ã½ tÃ¬m kiáº¿m"></div>
    </div>
    <div class="gm-right">
      <button class="gm-chip" id="btnAccount" title="TÃ i khoáº£n">ğŸ‘¤</button>
    </div>
  </div>

  <!-- ===== FLOATING BUTTONS ===== -->
  <div class="fab-wrap">
    <button class="fab fab-secondary" title="Lá»›p" onclick="toggleFilters()">â˜·</button>
  </div>

  <!-- ===== BOTTOM SHEET ===== -->
  <div id="bottomSheet" class="bottom-sheet">
    <div class="sheet-handle"></div>
    <div id="propertyList"></div>
  </div>

  <!-- ===== FILTER PANEL ===== -->
  <div id="filterPanel" class="filter-panel">
    <div class="filter-title">Lá»c theo tÃ¬nh tráº¡ng</div>
    <div class="filter-grid" id="statusChips"></div>

    <div class="filter-title">Khu vá»±c</div>
    <div id="areaList" class="filter-grid">
      <div class="filter-chip active area-chip" data-area="__ALL__">Táº¥t cáº£</div>
    </div>

    <div class="filter-title">Lá»›p hiá»ƒn thá»‹</div>
    <div class="filter-grid">
      <div class="filter-chip active" id="layer-plots">LÃ´ má»™</div>
      <div class="filter-chip active" id="layer-labels">NhÃ£n</div>
      <div class="filter-chip active" id="layer-overlays">áº¢nh Overlay</div>
      <div class="filter-chip" id="layer-satellite">Vá»‡ tinh</div>
    </div>
  </div>
  <div id="filterOverlay" onclick="hideFilterPanel()"></div>

  <!-- ===== STATS ===== -->
  <div class="stats">
    <div class="stat-item">
      <div id="totalCount" class="stat-value">-</div>
      <div class="stat-label">Tá»•ng</div>
    </div>
    <div class="stat-item">
      <div id="availableCount" class="stat-value" style="color:#34C759">-</div>
      <div class="stat-label">Trá»‘ng</div>
    </div>
    <div class="stat-item">
      <div id="soldCount" class="stat-value" style="color:var(--primary)">-</div>
      <div class="stat-label">ÄÃ£ bÃ¡n</div>
    </div>
    <div class="stat-item">
      <div id="reservedCount" class="stat-value" style="color:#FF9500">-</div>
      <div class="stat-label">Äáº·t cá»c</div>
    </div>
    <div class="stat-item">
      <div id="zoomLevel" class="stat-value">-</div>
      <div class="stat-label">Zoom</div>
    </div>
  </div>

  <!-- ===== SIDE MENU ===== -->
  <div id="sideMenu" class="side-menu" aria-hidden="true">
    <div class="menu-header">
      <img src="/assets/CPH-LOGO-1.png" alt="Logo" class="menu-logo">
      <strong>Báº£n Ä‘á»“ sá»‘ Hoa ViÃªn</strong>
      <small id="menuUserName" style="color:var(--primary)"></small>
    </div>

    <div class="menu-section-title">ğŸª¦ Huyá»‡t má»™ & LÃ´ Ä‘áº¥t</div>
    <div class="menu-item" onclick="centerMap()"><span class="icon">ğŸ—ºï¸</span>Báº£n Ä‘á»“ tá»•ng thá»ƒ</div>
    <div class="menu-item" onclick="toggleFilters()"><span class="icon">ğŸ”</span>Lá»c & tÃ¬m lÃ´ má»™</div>
    <div class="menu-item" onclick="openGmPaste()"><span class="icon">ğŸ“</span>DÃ¡n link/toáº¡ Ä‘á»™</div>
    <div class="menu-item" onclick="showToast('ğŸ“‹ Danh sÃ¡ch lÃ´ má»™')"><span class="icon">ğŸ“‹</span>Danh sÃ¡ch lÃ´ má»™</div>
    <div class="menu-item" onclick="showToast('ğŸ“¸ áº¢nh thá»±c táº¿')"><span class="icon">ğŸ“¸</span>áº¢nh thá»±c táº¿ / Overlay</div>
    <div class="menu-item" onclick="showToast('ğŸ“ Quy hoáº¡ch chi tiáº¿t')"><span class="icon">ğŸ“</span>Quy hoáº¡ch chi tiáº¿t</div>

    <div class="menu-section-title">ğŸ’¬ TÆ° váº¥n & BÃ¡n hÃ ng</div>
    <div class="menu-item" onclick="showToast('ğŸ§¾ BÃ¡o giÃ¡ nhanh')"><span class="icon">ğŸ’µ</span>BÃ¡o giÃ¡ nhanh</div>
    <div class="menu-item" onclick="showToast('ğŸ§‘â€ğŸ¤â€ğŸ§‘ TÆ° váº¥n khÃ¡ch hÃ ng')"><span class="icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</span>TÆ° váº¥n khÃ¡ch hÃ ng</div>
    <div class="menu-item" onclick="showToast('ğŸ—“ï¸ Lá»‹ch háº¹n / Äáº·t chá»—')"><span class="icon">ğŸ—“ï¸</span>Lá»‹ch háº¹n / Äáº·t chá»—</div>
    <div class="menu-item" onclick="showToast('ğŸª™ GÃ³i dá»‹ch vá»¥ / Æ¯u Ä‘Ã£i')"><span class="icon">ğŸª™</span>GÃ³i dá»‹ch vá»¥ / Æ¯u Ä‘Ã£i</div>
    <div class="menu-item" onclick="showToast('ğŸš— Dáº«n Ä‘Æ°á»ng tá»›i lÃ´')"><span class="icon">ğŸš—</span>Dáº«n Ä‘Æ°á»ng tá»›i lÃ´</div>

    <div class="menu-section-title">ğŸ§± Quáº£n lÃ½ & Nghiá»‡p vá»¥</div>
    <div class="menu-item" data-action="satellite" onclick="toggleLayerSatellite()">
      <span class="icon">ğŸ›°ï¸</span>Vá»‡ tinh
    </div>
    <div class="menu-item" onclick="showToast('ğŸ§° CÃ´ng cá»¥ Ä‘o Ä‘áº¡c')"><span class="icon">ğŸ§°</span>CÃ´ng cá»¥ Ä‘o Ä‘áº¡c</div>
    <div class="menu-item" onclick="showToast('ğŸ“Š BÃ¡o cÃ¡o nhanh')"><span class="icon">ğŸ“Š</span>BÃ¡o cÃ¡o nhanh</div>
    <div class="menu-item" onclick="toggleSpiritualSites()"><span class="icon">ğŸ•</span>CÃ´ng trÃ¬nh tÃ¢m linh</div>
    <div class="menu-item" onclick="showToast('ğŸ—ï¸ CÃ´ng trÃ¬nh Ä‘ang thi cÃ´ng')"><span class="icon">ğŸ—ï¸</span>CÃ´ng trÃ¬nh Ä‘ang thi cÃ´ng</div>
    <div class="menu-item" onclick="showToast('ğŸ”„ Äá»“ng bá»™ dá»¯ liá»‡u')"><span class="icon">ğŸ”„</span>Äá»“ng bá»™ dá»¯ liá»‡u</div>

    <div class="menu-section-title">â„¹ï¸ ThÃ´ng tin & Há»— Trá»£</div>
    <div class="menu-item" onclick="showToast('ğŸ¢ Giá»›i thiá»‡u Hoa ViÃªn')"><span class="icon">ğŸ¢</span>Giá»›i thiá»‡u Hoa ViÃªn</div>
    <div class="menu-item" onclick="showToast('ğŸ•¯ï¸ VÄƒn hÃ³a & Nghi lá»…')"><span class="icon">ğŸ•¯ï¸</span>VÄƒn hÃ³a & Nghi lá»…</div>
    <div class="menu-item" onclick="showToast('ğŸ“– HÆ°á»›ng dáº«n sá»­ dá»¥ng')"><span class="icon">ğŸ“–</span>HÆ°á»›ng dáº«n sá»­ dá»¥ng</div>
    <div class="menu-item" onclick="showToast('â˜ï¸ LiÃªn há»‡ há»— trá»£')"><span class="icon">â˜ï¸</span>LiÃªn há»‡ há»— trá»£</div>
    <div class="menu-item" onclick="showToast('ğŸ”— LiÃªn káº¿t nhanh')"><span class="icon">ğŸ”—</span>LiÃªn káº¿t nhanh</div>
  </div>

  <!-- PROFILE OVERLAY -->
  <div id="profileOverlay" onclick="toggleProfile(false)"></div>
  <div id="profilePanel" class="profile-panel" role="dialog" aria-modal="true" aria-labelledby="profName" style="display:none">
    <div class="profile-head">
      <div id="profAvatar" class="profile-avatar">?</div>
      <div>
        <div id="profName" class="profile-name">Äang táº£iâ€¦</div>
        <div id="profBranch" class="profile-branch"></div>
      </div>
    </div>

    <div class="profile-list">
      <div class="profile-row">
        <div class="k">Email</div>
        <div id="profEmail" class="v">â€”</div>
      </div>
      <div class="profile-row">
        <div class="k">Äiá»‡n thoáº¡i</div>
        <div id="profPhone" class="v">â€”</div>
      </div>
      <div class="profile-row">
        <div class="k">Vai trÃ²</div>
        <div id="profRole" class="v">â€”</div>
      </div>
    </div>

    <div class="profile-actions">
      <button class="btn-outline" onclick="copyUserEmail()">ğŸ“‹ Copy email</button>
      <button class="btn-outline" onclick="copySid()">ğŸ”‘ Copy SID</button>
      <button class="btn-danger" onclick="logout()">ÄÄƒng xuáº¥t</button>
    </div>
  </div>

  <!-- QR MODAL -->
  <div id="qrOverlay" onclick="if(event.target.id==='qrOverlay') hideQR()">
    <div class="qr-card">
      <button class="qr-close" onclick="hideQR()">âœ–</button>
      <h3>QuÃ©t mÃ£ Ä‘á»ƒ dáº«n Ä‘Æ°á»ng</h3>
      <img id="qrImg" class="qr-img" alt="QR code" />
      <div id="qrUrlText" class="qr-link"></div>
      <div class="qr-actions">
        <button onclick="copyQRLink()">ğŸ“‹ Copy link</button>
        <a id="qrOpenBtn" target="_blank">ğŸš— Má»Ÿ Google Maps</a>
      </div>
    </div>
  </div>

  <!-- Google Maps paste widget -->
  <div class="gmpaste-wrap" id="gmpaste-root" aria-live="polite"
       onclick="if(event.target.id==='gmpaste-root') closeGmPaste()">
    <div class="gmpaste">
      <input id="gmaps-input" placeholder="DÃ¡n link Google Maps hoáº·c nháº­p toáº¡ Ä‘á»™: 11.1720208, 106.6499036 â€¦ rá»“i nháº¥n Enter" />
      <button class="gmpaste-btn gmpaste-btn--copy" id="gmaps-copy">Copy toáº¡ Ä‘á»™</button>
      <button class="gmpaste-btn gmpaste-btn--go"   id="gmaps-go">TÃ¬m</button>
      <button class="gmpaste-btn" onclick="closeGmPaste()" title="ÄÃ³ng">âœ–</button>
    </div>
  </div>

  <!-- JS chÃ­nh -->
  <script src="ocm-hybrid.js"></script>
</body>
</html>
